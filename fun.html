<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fun</title>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css">
</head>
<body class="dark-mode">
  <nav id="top-nav">
    <a href="index.html">home</a>
    <a href="fun.html">fun</a>
    <a href="play.html">play</a>
    <a href="custom.html">custom</a>
    <a href="versus.html">versus</a>
  </nav>
  <div id="fun-content" style="margin-top:50px;"></div>
  <script>
    document.addEventListener('DOMContentLoaded', async () => {
      const container = document.getElementById('fun-content');
      const resp = await fetch('users/bots.json');
      const data = await resp.json();
      const entries = data.bots.map(b => {
        const modes = Object.values(b.modes);
        const avgAcc = modes.reduce((s, m) => s + m.precisao, 0) / modes.length;
        const avgTempo = modes.reduce((s, m) => s + m.tempo, 0) / modes.length;
        const score = (avgAcc + avgTempo) / 2;
        return { name: b.name, score, file: b.file };
      });
      const vsStats = JSON.parse(localStorage.getItem('versusStats') || '{}');
      const userAcc = parseFloat(vsStats.accuracy) || 0;
      const userTempo = parseFloat(vsStats.speed) || 0;
      const userScore = (userAcc + userTempo) / 2;
      entries.push({ name: 'VocÃª', score: userScore, file: 'theuser.png' });
      entries.sort((a, b) => b.score - a.score);
      entries.forEach(e => {
        const row = document.createElement('div');
        row.className = 'ranking-row';

        const img = document.createElement('img');
        img.src = `users/${e.file}`;
        img.className = 'ranking-avatar';

        const name = document.createElement('span');
        name.className = 'ranking-name';
        name.textContent = e.name;

        const score = document.createElement('span');
        score.className = 'ranking-score';
        score.textContent = `${Math.round(e.score)}%`;

        row.appendChild(img);
        row.appendChild(name);
        row.appendChild(score);
        container.appendChild(row);
      });
    });
  </script>
</body>
</html>
